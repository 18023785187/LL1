function r(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=new Array(t);n<t;n++)e[n]=r[n];return e}function t(t,n){if(t){if("string"==typeof t)return r(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}function n(r,n){return function(r){if(Array.isArray(r))return r}(r)||function(r,t){var n=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var e,o,a,i,u=[],f=!0,l=!1;try{if(a=(n=n.call(r)).next,0===t){if(Object(n)!==n)return;f=!1}else for(;!(f=(e=a.call(n)).done)&&(u.push(e.value),u.length!==t);f=!0);}catch(r){l=!0,o=r}finally{try{if(!f&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return u}}(r,n)||t(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(n){return function(t){if(Array.isArray(t))return r(t)}(n)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(n)||t(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o=null,a="|",i="$";function u(r,t){return new Set([].concat(e(r),e(t)))}function f(r){return" "===r||"\t"===r||"\n"===r||"\r"===r}function l(r){for(var t=[],e=new Map,a=0;a<r.length;++a){var i=n(r[a].split("->"),2),u=i[0],l=i[1];if(!l||!l.trim())throw new Error("Grammar is missing the right side");var c=!0;e.has(u)||(c=!1,e.set(u,{left:null,right:[]}));var h=e.get(u);h.left=u.trim();var s=[],v="";l+=" ";for(var p=0;p<l.length;++p){var g=l[p];f(g)?("null"===v?s.push(o):v&&s.push(v),v=""):"|"===g?(h.right.push(s),s=[],v=""):v+=g}s.length&&h.right.push(s),!c&&t.push(h)}return t}function c(r){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return r.forEach((function(r){var e=r.left,o=r.right;if(t)o.forEach((function(r){var t="";t+="".concat(e," -> ").concat(r.map((function(r){return r+""})).join(" ")),n.push(t)}));else{var i="";i+="".concat(e," -> "),o.forEach((function(r){i+=r.map((function(r){return r+""})).join(" ")+" ".concat(a," ")})),n.push(i.slice(0,-3))}})),n}function h(r){var t=function(r){return r.join(a)},n=[],i=new Map;function u(r,f){i.set(t(f),r);var l,c,h=0,s=!1,v={left:r,right:[]};if(1===f.length)return v.right=function(r){return e(r.map((function(r){return e(r)})))}(f),void n.push(v);for(var p=[],g=0;g<f.length;++g)if(!p.includes(g)){if(p.push(g),g===f.length-1)return void v.right.push(f[g]);var y=f[g],d=0,m=[];m.push(y),l="";r:for(;d<y.length;){c=y[d];var b=!1;if(0===d)for(var w=g+1;w<f.length;++w){var S=f[w][d];S&&(S===c&&(b=!0,p.push(w),m.push(f[w])))}else for(var A=g+1;A<f.length;++A){var E=f[A][d];E&&E===c&&p.includes(A)&&(b=!0)}if(!b)break r;l+=c+a,d++}if(l){var j=m.map((function(r){var t=r.slice(l.slice(0,-1).split(a).length);return t.length?t:[o]})),I=void 0;I=i.has(t(j))?i.get(t(j)):"".concat(r).concat("'".repeat(h),"'");var M=[].concat(e(l.slice(0,-1).split(a)),[I]);v.right.push(M),s||(n.push(v),h++),i.has(t(j))||u(I,j)}else v.right.push(e(f[g])),s||n.push(v);s=!0}}return r.forEach((function(r){var n=r.left,e=r.right;i.set(t(e),n)})),r.forEach((function(r){u(r.left,r.right)})),n}function s(r){var t=[];return r.forEach((function(r){t.push.apply(t,e(function(r){var t=r.left,n=r.right,e=[],a="".concat(t,"`"),i=[],u=[],f=!1;n.forEach((function(r){r[0]===t?(r.shift(),r.push(a),i.push(r)):r[0]===o?f=!0:(r.push(a),u.push(r))})),f&&u.push([a]);return e.push({left:t,right:[].concat(u)},{left:a,right:[].concat(i,[[o]])}),e}(r)))})),t}function v(r,t){var n,a=function(r){return t.includes(r)||r===o},f={};r.forEach((function(r){var t=r.left;return f[t]=[]}));do{n=!1,r.forEach((function(r){var t=r.left,l=r.right,c=new Set(f[t]),h=c.size;l.forEach((function(r){for(var t=0,n=r[t];(null===(e=n)||void 0===e?void 0:e[0])===i;){var e;n=r[++t]}if(a(n))c.add(n);else if(f[n].includes(o)){do{var l,h=new Set(f[n]);for(h.delete(o),c=u(c,h),n=r[t+=1];(null===(s=n)||void 0===s?void 0:s[0])===i;){var s;n=r[++t]}}while(null!==(l=f[n])&&void 0!==l&&l.includes(o));a(n)?c.add(n):n&&(c=u(c,f[n]))}else c=u(c,f[n])})),f[t]=e(c),h!==c.size&&(n=!0)}))}while(n);return f}function p(r,t,n){var a=[];return r.some((function(r){if(r[0]===i)return!1;if(function(r){return n.includes(r)||r===o}(r))a.push(r);else{if(t[r].includes(o))return!1;a.push.apply(a,e(t[r]))}return!0})),a}function g(r,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v(r,t),a=function(r){return t.includes(r)||r===o},f={};r.forEach((function(r){var t=r.left;return f[t]=[]})),f[r[0].left].push(i);var l,c=new Set;for(var h in n)n[h].includes(o)&&c.add(h);do{l=!1,r.forEach((function(r){var t=r.left;r.right.forEach((function(r){for(var h=r.length-1;h>=0;--h){var s=r[h];if(!a(s)&&s[0]!==i){var v=f[s].length;if(h===r.length-1)f[s]=e(u(f[s],f[t]));else{for(var p=h+1,g=r[p];p<r.length&&g[0]===i;)g=r[++p];if(a(g))f[s]=e(u(f[s],[g]));else{var y=new Set(n[g]);for(y.delete(o),f[s]=e(u(f[s],y));p<r.length&&(c.has(g)||g[0]===i);)g=r[++p];p===r.length&&(f[s]=e(u(f[s],f[t])))}}f[s].length!==v&&(l=!0)}}}))}))}while(l);return f}function y(r,t){var n="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=function(r,t){if(!r)return;if("string"==typeof r)return d(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(r);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(r,t)}(r))||t&&r&&"number"==typeof r.length){n&&(r=n);var e=0,o=function(){};return{s:o,n:function(){return e>=r.length?{done:!0}:{done:!1,value:r[e++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){n=n.call(r)},n:function(){var r=n.next();return i=r.done,r},e:function(r){u=!0,a=r},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw a}}}}function d(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=new Array(t);n<t;n++)e[n]=r[n];return e}function m(r,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v(r,t),e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g(r,t),a=new Map;return r.forEach((function(r){var u=r.left;r.right.forEach((function(r){for(var f=0,l=r[f],c={left:u,right:r};f<r.length&&l&&l[0]===i;)l=r[++f];l===o?a.set(c,e[u]):a.set(c,p(r,n,t))}))})),a}function b(r){var t,e=new Map,o=y(r);try{for(o.s();!(t=o.n()).done;){var a=n(t.value,2),i=a[0].left,f=a[1];if(e.has(i)){var l=e.get(i),c=u(l,f);if(c.size!==l.size+f.length)return!1;e.set(i,c)}else e.set(i,new Set(f))}}catch(r){o.e(r)}finally{o.f()}return!0}function w(r,t){var n="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=function(r,t){if(!r)return;if("string"==typeof r)return S(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(r);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(r,t)}(r))||t&&r&&"number"==typeof r.length){n&&(r=n);var e=0,o=function(){};return{s:o,n:function(){return e>=r.length?{done:!0}:{done:!1,value:r[e++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){n=n.call(r)},n:function(){var r=n.next();return i=r.done,r},e:function(r){u=!0,a=r},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw a}}}}function S(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=new Array(t);n<t;n++)e[n]=r[n];return e}function A(r){if(!b(r))throw new Error("Select set does not satisfy the LL(1) grammar");var t,e=new Map,o=w(r);try{var a=function(){var r=n(t.value,2),o=r[0],a=o.left,i=o.right;r[1].forEach((function(r){e.has(r)||e.set(r,new Map),e.get(r).set(a,i)}))};for(o.s();!(t=o.n()).done;)a()}catch(r){o.e(r)}finally{o.f()}return e}function E(r,t){var n="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=function(r,t){if(!r)return;if("string"==typeof r)return j(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(r);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(r,t)}(r))||t&&r&&"number"==typeof r.length){n&&(r=n);var e=0,o=function(){};return{s:o,n:function(){return e>=r.length?{done:!0}:{done:!1,value:r[e++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){n=n.call(r)},n:function(){var r=n.next();return i=r.done,r},e:function(r){u=!0,a=r},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw a}}}}function j(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=new Array(t);n<t;n++)e[n]=r[n];return e}function I(r,t){var e=l(r),o=v(e,t),a=g(e,t,o),i=m(e,t,o,a),u=A(i);return{startSymbol:e[0].left,firstSet:o,followSet:a,selectSet:i,predictSet:u,print:function(){var r,t=[],e=[],a=2,i=E(u);try{for(i.s();!(r=i.n()).done;){var f=n(r.value,1)[0];e.push(f),a=Math.max(a,f.length+2)}}catch(r){i.e(r)}finally{i.f()}for(var l in o)t.push(l),a=Math.max(a,l.length+2);for(var c=new Array(t.length+1).fill([]).map((function(){return new Array(e.length+1).fill("")})),h=0;h<e.length;++h)c[0][h+1]=e[h];for(var s=0;s<t.length;++s)c[s+1][0]=t[s];var v,p=E(u);try{for(p.s();!(v=p.n()).done;){var g,y=n(v.value,2),d=y[0],m=y[1],b=c[0].indexOf(d),w=void 0,S=E(m);try{for(S.s();!(g=S.n()).done;){for(var A=n(g.value,2),j=A[0],I=A[1],M=0;M<t.length;++M)if(c[M+1][0]===j){w=M+1;break}c[w][b]="-> ".concat(I.map((function(r){return r+""})).join(" ")),a=Math.max(a,c[w][b].length+2)}}catch(r){S.e(r)}finally{S.f()}}}catch(r){p.e(r)}finally{p.f()}for(var O="",x="\n"+("|"+"-".repeat(a+2)).repeat(e.length+1)+"|\n",T=0;T<c.length;++T){O+=x+"|";for(var $=0;$<c[T].length;++$){var z=0===T||0===$?" [33;1m "+c[T][$]+" [0m ":" [32;1m "+c[T][$]+" [0m ";O+=z+" ".repeat(a+13-z.length)+"|"}}O+=x,console.log(O)}}}export{i as $,o as EMPTY_CHAIN,s as clearLeftRecursion,h as combineLikeTerms,b as isNotIntersect,v as makeFirstSet,g as makeFollowSet,I as makeLL1,A as makePredictSet,m as makeSelectSet,p as makeUnionFirstSet,l as splitGrammars,c as toGrammars};
